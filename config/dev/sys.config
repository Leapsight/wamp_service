[
 %% service conf
 %% TODO: remove session pool?
 {wamp_service,
  [
   {session_pools,
    [
     {wamp_sessions,
      [
       %% pool args
       {size, 1},
       {max_overflow, 1}
      ], [
          %% worker args
          %% wamp opts
          {hostname, "localhost"},
          {port, 18082},
          {realm, <<"com.magenta.test">>},
          {encoding,  msgpack},
          %% reconnect options
          {backoff, 100},
          {retries, 10},
          %% service callbacks
          {callbacks,
           [
            {procedure, <<"com.example.add2">>, {wamp_service_example, add}},
            {procedure, <<"com.example.echo">>, {wamp_service_example, echo}},
            {procedure, <<"com.example.circular">>, {wamp_service_example, circular}},
            {procedure, <<"com.example.unknown_error">>, {wamp_service_example, unknown_error}},
            {procedure, <<"com.example.notfound_error">>, {wamp_service_example, notfound_error}},
            {procedure, <<"com.example.validation_error">>, {wamp_service_example, validation_error}},
            {procedure, <<"com.example.timeout">>, {wamp_service_example, timeout}},
            {subscription, <<"com.example.onhello">>, {wamp_service_example, onhello}}
           ]}
         ]},
     {wamp_call_sessions,
      [
       %% pool args
       {size, 2},
       {max_overflow, 10}
      ], [
          %% worker args
          %% wamp opts
          {hostname, "localhost"},
          {port, 18082},
          {realm, <<"com.magenta.test">>},
          {encoding,  msgpack},
          %% reconnect options
          {backoff, 100},
          {retries, 10},
          %% service callbacks
          {callbacks, []}
         ]}
    ]}
  ]},

 {lager,
  [
   {log_root, "log"},
   %% Default handlers for lager/lager_event
   {handlers,
    [
     {lager_console_backend, debug}
    ]},

   %% Any other sinks
   {extra_sinks,
    [
     {audit_lager_event,
      [{handlers,
        [
         {lager_console_backend, debug}
        ]
       },
       {async_threshold, 500},
       {async_threshold_window, 50}]
     }]
   }
  ]},

 {sasl, [{sasl_error_logger, false}]}
].
